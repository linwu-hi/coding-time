<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://www.coding-time.cn/lc/algorithms/image-processing/seam-carving/README.ru-RU.html"><meta property="og:site_name" content="ÁºñÁ®ãÊó∂ÂÖâ"><meta property="og:title" content="–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ JavaScript"><meta property="og:description" content="Content-aware image resizing in JavaScript –î–æ—Å—Ç—É–ø–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ (https://trekhleb.dev/blog/2021/content-aware-image-resizing-in-javascript/) –≤ –∫–æ..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-07-14T16:27:54.000Z"><meta property="article:author" content="linwu"><meta property="article:modified_time" content="2023-07-14T16:27:54.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ JavaScript","image":[""],"dateModified":"2023-07-14T16:27:54.000Z","author":[{"@type":"Person","name":"linwu","url":"https://www.coding-time.cn","email":"linwu.hi@gmail.com"}]}</script><meta name="baidu-site-verification" content="codeva-IkQhVRqkxI"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/image/favicon.ico"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/logo.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/logo.svg"><meta name="msapplication-TileColor" content="#ffffff"><title>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ JavaScript | ÁºñÁ®ãÊó∂ÂÖâ</title><meta name="description" content="Content-aware image resizing in JavaScript –î–æ—Å—Ç—É–ø–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ (https://trekhleb.dev/blog/2021/content-aware-image-resizing-in-javascript/) –≤ –∫–æ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-3dcfc125.css" as="style"><link rel="stylesheet" href="/assets/style-3dcfc125.css">
    <link rel="modulepreload" href="/assets/app-d7df62a4.js"><link rel="modulepreload" href="/assets/README.ru-RU.html-e5f66cbc.js"><link rel="modulepreload" href="/assets/README.ru-RU.html-d1b156da.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Ë∑≥Ëá≥‰∏ªË¶ÅÂÖßÂÆπ</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="vp-brand"><img class="vp-nav-logo" src="/logo.svg" alt="ÁºñÁ®ãÊó∂ÂÖâ"><!----><span class="vp-site-name hide-in-pad">ÁºñÁ®ãÊó∂ÂÖâ</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a href="/js/preamble.html" class="nav-link" aria-label="Áé∞‰ª£JavascriptÈ´òÁ∫ßÊïôÁ®ã"><span class="font-icon icon iconfont icon-javascript" style=""></span>Áé∞‰ª£JavascriptÈ´òÁ∫ßÊïôÁ®ã<!----></a></div><div class="nav-item hide-in-mobile"><a href="/dart/preamble.html" class="nav-link" aria-label="Ê∑±ÂÖ•ÊµÖÂá∫Dart"><span class="font-icon icon iconfont icon-ability" style=""></span>Ê∑±ÂÖ•ÊµÖÂá∫Dart<!----></a></div><div class="nav-item hide-in-mobile"><a href="/lc/preamble.html" class="nav-link" aria-label="linwuÁöÑÁÆóÊ≥ïÁ¨îËÆ∞"><span class="font-icon icon iconfont icon-note" style=""></span>linwuÁöÑÁÆóÊ≥ïÁ¨îËÆ∞<!----></a></div><div class="nav-item hide-in-mobile"><a href="/ts/preamble.html" class="nav-link" aria-label="Áé∞‰ª£TypescriptÈ´òÁ∫ßÊïôÁ®ã"><span class="font-icon icon iconfont icon-typescript" style=""></span>Áé∞‰ª£TypescriptÈ´òÁ∫ßÊïôÁ®ã<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://gitee.com/linwu-hi/coding-time-chrome" rel="noopener noreferrer" target="_blank" aria-label="Ë∞∑Ê≠åÊèí‰ª∂Â∞èÂÜå" class="nav-link"><!---->Ë∞∑Ê≠åÊèí‰ª∂Â∞èÂÜå<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><a href="/md" class="nav-link" aria-label="MarkdownÁºñËæëÂô®"><!---->MarkdownÁºñËæëÂô®<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/linwu-hi/coding-time" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a href="/lc/preamble.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Â∫èË®Ä"><!---->Â∫èË®Ä<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable"><!----><a href="/lc/data-structures/linked-list" class="nav-link vp-sidebar-title" aria-label="Êï∞ÊçÆÁªìÊûÑ"><!---->Êï∞ÊçÆÁªìÊûÑ<!----></a><!----></p><ul class="vp-sidebar-links"><li><!--[--><a href="/lc/data-structures/linked-list" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="ÈìæË°®"><!---->ÈìæË°®<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/doubly-linked-list" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="ÂèåÂêëÈìæË°®"><!---->ÂèåÂêëÈìæË°®<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/queue" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="ÈòüÂàó"><!---->ÈòüÂàó<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/stack" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Ê†à"><!---->Ê†à<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/priority-queue" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="‰ºòÂÖàÈòüÂàó"><!---->‰ºòÂÖàÈòüÂàó<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/hash-table" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="ÂìàÂ∏åË°®"><!---->ÂìàÂ∏åË°®<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/graph" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Âõæ"><!---->Âõæ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/heap" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Â†Ü"><!---->Â†Ü<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/lru-cache" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="LRU"><!---->LRU<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/disjoint-set" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="‰∏çÁõ∏‰∫§ÈõÜ"><!---->‰∏çÁõ∏‰∫§ÈõÜ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lc/data-structures/bloom-filter" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Â∏ÉÈöÜËøáÊª§Âô®"><!---->Â∏ÉÈöÜËøáÊª§Âô®<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><a href="/lc/data-structures/tree/binary-search-tree" class="nav-link vp-sidebar-title" aria-label="Ê†ë"><!---->Ê†ë<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><!--[--><a href="/lc/data-structures/trie" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Â≠óÂÖ∏Ê†ë"><!---->Â≠óÂÖ∏Ê†ë<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable"><!----><a href="/lc/algorithms/binary-search" class="nav-link vp-sidebar-title" aria-label="ÁÆóÊ≥ï"><!---->ÁÆóÊ≥ï<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">ÊéíÂ∫è</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">ÊêúÁ¥¢</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">ÈìæË°®</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><a href="/lc/algorithms/stack/preamble.html" class="nav-link vp-sidebar-title" aria-label="Ê†à"><!---->Ê†à<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><a href="/lc/algorithms/queue/preamble.html" class="nav-link vp-sidebar-title" aria-label="ÈòüÂàó"><!---->ÈòüÂàó<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><a href="/lc/algorithms/two-pointers/preamble.html" class="nav-link vp-sidebar-title" aria-label="ÂèåÊåáÈíà"><!---->ÂèåÊåáÈíà<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><a href="/lc/algorithms/sliding-window/preamble.html" class="nav-link vp-sidebar-title" aria-label="ÊªëÂä®Á™óÂè£"><!---->ÊªëÂä®Á™óÂè£<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><a href="/lc/algorithms/dynamic-programming/preamble.html" class="nav-link vp-sidebar-title" aria-label="Âä®ÊÄÅËßÑÂàí"><!---->Âä®ÊÄÅËßÑÂàí<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><a href="/lc/algorithms/greedy-algorithm/preamble.html" class="nav-link vp-sidebar-title" aria-label="Ë¥™ÂøÉÁÆóÊ≥ï"><!---->Ë¥™ÂøÉÁÆóÊ≥ï<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Ê†ë</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Â≠óÁ¨¶‰∏≤(ÂèØÈÄâ)</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Âõæ(ÂèØÈÄâ)</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">ÁªüËÆ°Êï∞ÊçÆ(ÂèØÈÄâ)</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ JavaScript</h1><div class="page-info"><span class="page-author-info" aria-label="‰ΩúËÄÖüñä" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.coding-time.cn" target="_blank" rel="noopener noreferrer">linwu</a></span><span property="author" content="linwu"></span></span><!----><span class="page-date-info" aria-label="ÂÜô‰ΩúÊó•ÊúüüìÖ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-07-14T16:27:54.000Z"></span><!----><span class="page-reading-time-info" aria-label="ÈòÖËØªÊó∂Èó¥‚åõ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>Â§ßÁ∫¶ 14 ÂàÜÈíü</span><meta property="timeRequired" content="PT14M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">Ê≠§È°µÂÜÖÂÆπ<button type="button" class="print-button" title="ÊâìÂç∞"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#tl-dr" class="router-link-active router-link-exact-active toc-link level2">TL;DR</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#–∏–∑–º–µ–Ω–µ–Ω–∏–µ-—Ä–∞–∑–º–µ—Ä–æ–≤-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏-—Å-—É—á–µ—Ç–æ–º-–∏—Ö-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ" class="router-link-active router-link-exact-active toc-link level3">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —É—á–µ—Ç–æ–º –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#—É–¥–∞–ª–µ–Ω–∏–µ-–æ–±—ä–µ–∫—Ç–æ–≤" class="router-link-active router-link-exact-active toc-link level3">–£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–∏-—Ä–µ—Å–∑–∞–∏–∑–µ—Ä" class="router-link-active router-link-exact-active toc-link level3">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ—Å–∑–∞–π–∑–µ—Ä</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#–¥—Ä—É–≥–∏–µ-–ø—Ä–∏–º–µ—Ä—ã-—Ä–µ—Å–∞–∏–∑–∞" class="router-link-active router-link-exact-active toc-link level3">–î—Ä—É–≥–∏–µ –ø—Ä–∏–º–µ—Ä—ã —Ä–µ—Å–∞–π–∑–∞</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-–∞–ª–≥–æ—Ä–∏—Ç–º-seam-carving" class="router-link-active router-link-exact-active toc-link level2">–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º Seam Carving</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-–Ω–∞-typescript" class="router-link-active router-link-exact-active toc-link level2">–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ TypeScript</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#—É–º–µ–Ω—å—à–µ–Ω–∏–µ-—à–∏—Ä–∏–Ω—ã-—Å-—É—á–µ—Ç–æ–º-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è-–∏—Å—Ö–æ–¥–Ω–∞—è-—Ñ—É–Ω–∫—Ü–∏—è" class="router-link-active router-link-exact-active toc-link level3">–£–º–µ–Ω—å—à–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã —Å —É—á–µ—Ç–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∏—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#—Ä–∞—Å—á–µ—Ç-—ç–Ω–µ—Ä–≥–∏–∏-–ø–∏–∫—Å–µ–ª—è" class="router-link-active router-link-exact-active toc-link level3">–†–∞—Å—á–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏ –ø–∏–∫—Å–µ–ª—è</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#—Ä–∞—Å—á–µ—Ç-—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–∏-–∫–∞—Ä—Ç—ã" class="router-link-active router-link-exact-active toc-link level3">–†–∞—Å—á–µ—Ç —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç—ã</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ-—à–≤–∞-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–∏-—ç–Ω–µ—Ä–≥–∏–µ–∏-–ø—Ä–∏–º–µ–Ω—è–µ–º-–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" class="router-link-active router-link-exact-active toc-link level3">–ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ —à–≤–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π (–ø—Ä–∏–º–µ–Ω—è–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#—É–¥–∞–ª–µ–Ω–∏–µ-—à–≤–∞-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–∏-—ç–Ω–µ—Ä–≥–∏–µ–∏" class="router-link-active router-link-exact-active toc-link level3">–£–¥–∞–ª–µ–Ω–∏–µ —à–≤–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#—É–¥–∞–ª–µ–Ω–∏–µ-–æ–±—ä–µ–∫—Ç–æ–≤-—Å-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è" class="router-link-active router-link-exact-active toc-link level2">–£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lc/algorithms/image-processing/seam-carving/README.ru-RU.html#–ø—Ä–æ–±–ª–µ–º—ã-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-–∏-–¥–∞–ª—å–Ω–µ–∏—à–∏–µ-–ø–ª–∞–Ω—ã" class="router-link-active router-link-exact-active toc-link level2">–ü—Ä–æ–±–ª–µ–º—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏ –¥–∞–ª—å–Ω–µ–π—à–∏–µ –ø–ª–∞–Ω—ã</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="–∏–∑–º–µ–Ω–µ–Ω–∏–µ-—Ä–∞–∑–º–µ—Ä–æ–≤-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è-—Å-—É—á–µ—Ç–æ–º-–µ–≥–æ-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ-–≤-javascript" tabindex="-1"><a class="header-anchor" href="#–∏–∑–º–µ–Ω–µ–Ω–∏–µ-—Ä–∞–∑–º–µ—Ä–æ–≤-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è-—Å-—É—á–µ—Ç–æ–º-–µ–≥–æ-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ-–≤-javascript" aria-hidden="true">#</a> –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ JavaScript</h1><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/01-cover-02.png" alt="Content-aware image resizing in JavaScript" tabindex="0" loading="lazy"><figcaption>Content-aware image resizing in JavaScript</figcaption></figure><blockquote><p>–î–æ—Å—Ç—É–ø–Ω–∞ <a href="https://trekhleb.dev/blog/2021/content-aware-image-resizing-in-javascript/" target="_blank" rel="noopener noreferrer">–∞–Ω–≥–ª–∏–π—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º &quot;—Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è&quot; —Å –Ω–∏–º–∏.</p></blockquote><h2 id="tl-dr" tabindex="-1"><a class="header-anchor" href="#tl-dr" aria-hidden="true">#</a> TL;DR</h2><p>–ù–∞–ø–∏—Å–∞–Ω–æ –º–Ω–æ–≥–æ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π –æ–± –∞–ª–≥–æ—Ä–∏—Ç–º–µ <em>Seam Carving</em> (&quot;–í—ã—Ä–µ–∑–∞–Ω–∏–µ —à–≤–æ–≤&quot;), –Ω–æ —è –Ω–µ —Å–º–æ–≥ —É—Å—Ç–æ—è—Ç—å –ø–µ—Ä–µ–¥ —Å–æ–±–ª–∞–∑–Ω–æ–º —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π, –º–æ—â–Ω—ã–π –∏ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –∏ –Ω–∞–ø–∏—Å–∞—Ç—å –æ —Å–≤–æ–µ–º –ª–∏—á–Ω–æ–º –æ–ø—ã—Ç–µ —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º. –ú–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —Ç–∞–∫–∂–µ –ø—Ä–∏–≤–ª–µ–∫ —Ç–æ—Ç —Ñ–∞–∫—Ç, —á—Ç–æ –¥–ª—è –µ–≥–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ –º—ã –º–æ–∂–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å <em>–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ (DP)</em>. –ò, –µ—Å–ª–∏ –≤—ã, –∫–∞–∫ –∏ —è, –≤—Å–µ –µ—â–µ –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –Ω–∞ –ø—É—Ç–∏ –∏–∑—É—á–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Ç–æ —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ–±–æ–≥–∞—Ç–∏—Ç—å –≤–∞—à –ª–∏—á–Ω—ã–π –∞—Ä—Å–µ–Ω–∞–ª DP.</p><p>–ò—Ç–∞–∫, –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —è —Ö–æ—á—É —Å–¥–µ–ª–∞—Ç—å —Ç—Ä–∏ –≤–µ—â–∏:</p><ol><li>–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å &quot;–ø–æ–∏–≥—Ä–∞—Ç—å—Å—è&quot; —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ <strong>–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ—Å–∞–π–∑–µ—Ä–∞</strong>.</li><li>–û–±—ä—è—Å–Ω–∏—Ç—å <strong>–∏–¥–µ—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Seam Carving</strong>.</li><li>–û–±—ä—è—Å–Ω–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ <strong>–ø—Ä–∏–º–µ–Ω–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</strong> –¥–ª—è –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–º—ã –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å –Ω–∞ TypeScript).</li></ol><h3 id="–∏–∑–º–µ–Ω–µ–Ω–∏–µ-—Ä–∞–∑–º–µ—Ä–æ–≤-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏-—Å-—É—á–µ—Ç–æ–º-–∏—Ö-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ" tabindex="-1"><a class="header-anchor" href="#–∏–∑–º–µ–Ω–µ–Ω–∏–µ-—Ä–∞–∑–º–µ—Ä–æ–≤-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏-—Å-—É—á–µ—Ç–æ–º-–∏—Ö-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ" aria-hidden="true">#</a> –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —É—á–µ—Ç–æ–º –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ</h3><p><em>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ</em> (content-aware image resizing) –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–æ, –∫–æ–≥–¥–∞ –¥–µ–ª–æ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–º–µ–Ω—å—à–µ–Ω–∏—è —à–∏—Ä–∏–Ω—ã –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤—ã—Å–æ—Ç—ã), –∞ —Ç–∞–∫–∂–µ –∫–æ–≥–¥–∞ –ø–æ—Ç–µ—Ä—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —á–∞—Å—Ç–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞. –ü—Ä–æ—Å—Ç–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏—Å–∫–∞–∑–∏—Ç –Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –≤ –Ω–µ–º –æ–±—ä–µ–∫—Ç—ã. –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –æ–±—ä–µ–∫—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://perso.crans.org/frenoy/matlab2012/seamcarving.pdf" target="_blank" rel="noopener noreferrer">–∞–ª–≥–æ—Ä–∏—Ç–º Seam Carving<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –æ–ø–∏—Å–∞–Ω <em>Shai Avidan</em> –∏ <em>Ariel Shamir</em>.</p><p>–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ —à–∏—Ä–∏–Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª–∞ —É–º–µ–Ω—å—à–µ–Ω–∞ –Ω–∞ 50% <em>—Å —É—á–µ—Ç–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</em> (—Å–ª–µ–≤–∞) –∏ <em>–±–µ–∑ —É—á–µ—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</em> (—Å–ø—Ä–∞–≤–∞, –ø—Ä–æ—Å—Ç–æ–π —Å–∫–µ–π–ª–∏–Ω–≥). –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ª–µ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–≥–ª—è–¥–∏—Ç –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –≤–æ–∑–¥—É—à–Ω—ã—Ö —à–∞—Ä–æ–≤ –≤ –Ω–µ–º –±—ã–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/01-resizing-options.png" alt="Content-aware image resizing" tabindex="0" loading="lazy"><figcaption>Content-aware image resizing</figcaption></figure><p>–ò–¥–µ—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Seam Carving –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ <em>—à–æ–≤</em> (seam, –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∏–∫—Å–µ–ª–µ–π) —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –≤–ª–∏—è–Ω–∏–µ–º –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∞ –∑–∞—Ç–µ–º –µ–≥–æ <em>–≤—ã—Ä–µ–∑–∞—Ç—å</em> (carve). –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞, –ø–æ–∫–∞ –º—ã –Ω–µ –ø–æ–ª—É—á–∏–º —Ç—Ä–µ–±—É–µ–º—É—é —à–∏—Ä–∏–Ω—É –∏–ª–∏ –≤—ã—Å–æ—Ç—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –í –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –≤–∏–¥–Ω–æ, —á—Ç–æ –ø–∏–∫—Å–µ–ª–∏ –≤–æ–∑–¥—É—à–Ω—ã—Ö —à–∞—Ä–æ–≤ –≤–Ω–æ—Å—è—Ç –±–æ–ª—å—à–∏–π &quot;–≤–∫–ª–∞–¥&quot; –≤ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏ —Å–º—ã—Å–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —á–µ–º –ø–∏–∫—Å–µ–ª–∏ –Ω–µ–±–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª—è—é—Ç—Å—è –ø–∏–∫—Å–µ–ª–∏ –Ω–µ–±–∞.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/10-demo-01.gif" alt="JS IMAGE CARVER DEMO" tabindex="0" loading="lazy"><figcaption>JS IMAGE CARVER DEMO</figcaption></figure><p>–ü–æ–∏—Å–∫ —à–≤–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π (—Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –≤–∫–ª–∞–¥–æ–º –≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) —è–≤–ª—è–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π). –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ —à–≤–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–æ <em>–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</em> (–º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∏–∂–µ).</p><h3 id="—É–¥–∞–ª–µ–Ω–∏–µ-–æ–±—ä–µ–∫—Ç–æ–≤" tabindex="-1"><a class="header-anchor" href="#—É–¥–∞–ª–µ–Ω–∏–µ-–æ–±—ä–µ–∫—Ç–æ–≤" aria-hidden="true">#</a> –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤</h3><p>–í–∞–∂–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è (—Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º–∞—è —ç–Ω–µ—Ä–≥–∏—è –ø–∏–∫—Å–µ–ª—è) –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥—è –∏–∑ –µ–≥–æ —Ü–≤–µ—Ç–æ–≤–æ–π —Ä–∞–∑–Ω–∏—Ü—ã (<code>R</code>, <code>G</code>, <code>B</code>, <code>A</code>) –º–µ–∂–¥—É –¥–≤—É–º—è —Å–æ—Å–µ–¥–Ω–∏–º–∏ –ø–∏–∫—Å–µ–ª—è–º–∏. –ï—Å–ª–∏ –∂–µ –º—ã –≤—Ä—É—á–Ω—É—é –∑–∞–¥–∞–¥–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø–∏–∫—Å–µ–ª—è–º –Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä –Ω–∞—Ä–∏—Å–æ–≤–∞–≤ –º–∞—Å–∫—É –ø–æ–≤–µ—Ä—Ö –Ω–∏—Ö), —Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º Seam Carving –≤—ã–ø–æ–ª–Ω–∏—Ç –¥–ª—è –Ω–∞—Å <strong>—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–º–µ—á–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞</strong>, –∫–∞–∫ –≥–æ–≤–æ—Ä–∏—Ç—Å—è, &quot;–∑–∞–±–µ—Å–ø–ª–∞—Ç–Ω–æ&quot;.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/10-demo-02.gif" alt="JS IMAGE CARVER OBJECT REMOVAL DEMO" tabindex="0" loading="lazy"><figcaption>JS IMAGE CARVER OBJECT REMOVAL DEMO</figcaption></figure><h3 id="–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–∏-—Ä–µ—Å–∑–∞–∏–∑–µ—Ä" tabindex="-1"><a class="header-anchor" href="#–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–∏-—Ä–µ—Å–∑–∞–∏–∑–µ—Ä" aria-hidden="true">#</a> –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ—Å–∑–∞–π–∑–µ—Ä</h3><p>–î–ª—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ —è —Å–æ–∑–¥–∞–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ <a href="https://trekhleb.dev/js-image-carver/" target="_blank" rel="noopener noreferrer">JS IMAGE CARVER<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (–¥–æ—Å—Ç—É–ø–µ–Ω —Ç–∞–∫–∂–µ –∏ <a href="https://github.com/trekhleb/js-image-carver" target="_blank" rel="noopener noreferrer">–∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–∞ GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>), –∫–æ—Ç–æ—Ä—ã–º –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–µ—Å–∞–π–∑–∞ —Å–≤–æ–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —É–≤–∏–¥–µ—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º.</p><h3 id="–¥—Ä—É–≥–∏–µ-–ø—Ä–∏–º–µ—Ä—ã-—Ä–µ—Å–∞–∏–∑–∞" tabindex="-1"><a class="header-anchor" href="#–¥—Ä—É–≥–∏–µ-–ø—Ä–∏–º–µ—Ä—ã-—Ä–µ—Å–∞–∏–∑–∞" aria-hidden="true">#</a> –î—Ä—É–≥–∏–µ –ø—Ä–∏–º–µ—Ä—ã —Ä–µ—Å–∞–π–∑–∞</h3><p>–í–æ—Ç –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ —Ç–æ–≥–æ, –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º —Ñ–æ–Ω–æ–º.</p><p>–ì–æ—Ä—ã –Ω–∞ –∑–∞–¥–Ω–µ–º –ø–ª–∞–Ω–µ –ø–ª–∞–≤–Ω–æ —Å–∂–∏–º–∞—é—Ç—Å—è, –±–µ–∑ –≤–∏–¥–∏–º—ã—Ö —à–≤–æ–≤.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/11-demo-01.png" alt="Resizing demo with more complex backgrounds" tabindex="0" loading="lazy"><figcaption>Resizing demo with more complex backgrounds</figcaption></figure><p>–¢–æ –∂–µ —Å–∞–º–æ–µ –∏ —Å –æ–∫–µ–∞–Ω—Å–∫–∏–º–∏ –≤–æ–ª–Ω–∞–º–∏. –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ö—Ä–∞–Ω–∏–ª –≤–æ–ª–Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–µ –∏—Å–∫–∞–∂–∞—è —Å–µ—Ä—Ñ–µ—Ä–æ–≤.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/11-demo-02.png" alt="Resizing demo with more complex backgrounds" tabindex="0" loading="lazy"><figcaption>Resizing demo with more complex backgrounds</figcaption></figure><p>–ù—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º Seam Carving –Ω–µ —è–≤–ª—è–µ—Ç—Å—è &quot;–≤–æ–ª—à–µ–±–Ω–æ–π —Ç–∞–±–ª–µ—Ç–∫–æ–π&quot;, –∏ –º–æ–∂–µ—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –≤–∞–∂–Ω—ã—Ö —á–∞—Å—Ç–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ <em>–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –ø–∏–∫—Å–µ–ª–µ–π –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –∫—Ä–∞—è, —Ä–µ–±—Ä–∞ –∏–ª–∏ –≥—Ä–∞–Ω–∏—Ü—ã</em> (–ø–æ—á—Ç–∏ –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏ –≤—ã–≥–ª—è–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤–∞–∂–Ω—ã–º–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞). –í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç.–∫. –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏ –≤—ã–≥–ª—è–¥—è—Ç –≤–∞–∂–Ω—ã–º–∏, –∏ –µ–º—É —Ç—Ä—É–¥–Ω–æ –æ—Ç–ª–∏—á–∏—Ç—å –ª–∏—Ü–æ –í–∞–Ω –ì–æ–≥–∞ –æ—Ç —Ñ–æ–Ω–∞.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/12-demo-01.png" alt="Example when the algorithm does not work as expected" tabindex="0" loading="lazy"><figcaption>Example when the algorithm does not work as expected</figcaption></figure><h2 id="–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-–∞–ª–≥–æ—Ä–∏—Ç–º-seam-carving" tabindex="-1"><a class="header-anchor" href="#–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-–∞–ª–≥–æ—Ä–∏—Ç–º-seam-carving" aria-hidden="true">#</a> –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º Seam Carving</h2><p>–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–º <code>1000 x 500 px</code>, –∏ –º—ã —Ö–æ—Ç–∏–º —É–º–µ–Ω—å—à–∏—Ç—å –µ–µ –¥–æ <code>500 x 500 px</code> (–¥–æ–ø—É—Å—Ç–∏–º, –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è Instagram). –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã, –≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞—Ö–æ—Ç–∏–º –∑–∞–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ <strong>—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø—Ä–æ—Ü–µ—Å—Å—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞</strong>:</p><ul><li><em>–í–∞–∂–Ω—ã–µ —á–∞—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã</em> (–µ—Å–ª–∏ –¥–æ —Ä–µ—Å–∞–π–∑–∞ –Ω–∞ —Ñ–æ—Ç–æ –±—ã–ª–æ 5 –¥–µ—Ä–µ–≤—å–µ–≤, —Ç–æ –∏ –ø–æ—Å–ª–µ —Ä–µ—Å–∞–π–∑–∞ –º—ã —Ö–æ—Ç–∏–º —É–≤–∏–¥–µ—Ç—å –≤—Å–µ —Ç–µ –∂–µ 5 –¥–µ—Ä–µ–≤—å–µ–≤).</li><li><em>–ü—Ä–æ–ø–æ—Ä—Ü–∏–∏ –≤–∞–∂–Ω—ã—Ö —á–∞—Å—Ç–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã</em> (–∫—Ä—É–≥–ª—ã–µ –∫–æ–ª–µ—Å–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –Ω–µ –¥–æ–ª–∂–Ω—ã —Å—Ç–∞—Ç—å –æ–≤–∞–ª—å–Ω—ã–º–∏ –ø–æ—Å–ª–µ —Ä–µ—Å–∞–π–∑–∞).</li></ul><p>–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∞–∂–Ω—ã—Ö —á–∞—Å—Ç–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ <strong>–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∏–∫—Å–µ–ª–µ–π (—à–æ–≤)</strong>, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏–¥—Ç–∏ –æ—Ç –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –∫ –Ω–∏–∂–Ω–µ–π –∏ –∏–º–µ—Ç—å <em>–Ω–∞–∏–º–µ–Ω—å—à–∏–π –≤–∫–ª–∞–¥ –≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</em> –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—à–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –≤–∞–∂–Ω—ã–µ —á–∞—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è), –∞ –∑–∞—Ç–µ–º —É–¥–∞–ª–∏—Ç—å –µ–≥–æ. –£–¥–∞–ª–µ–Ω–∏–µ —à–≤–∞ —Å–æ–∂–º–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –æ–¥–∏–Ω –ø–∏–∫—Å–µ–ª—å. –î–∞–ª–µ–µ –Ω–∞–¥–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å —ç—Ç–æ—Ç —à–∞–≥ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ —Å—Ç–∞–Ω–µ—Ç –Ω—É–∂–Ω–æ–π —à–∏—Ä–∏–Ω—ã.</p><p>–í–æ–ø—Ä–æ—Å –≤ —Ç–æ–º, –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å <em>–≤–∞–∂–Ω–æ—Å—Ç—å –ø–∏–∫—Å–µ–ª—è</em> –∏ –µ–≥–æ –≤–∫–ª–∞–¥ –≤ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ –∞–≤—Ç–æ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ—Ä–º–∏–Ω <strong>—ç–Ω–µ—Ä–≥–∏—è –ø–∏–∫—Å–µ–ª—è</strong>). –û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å ‚Äî —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏, –æ–±—Ä–∞–∑—É—é—â–∏–µ –∫—Ä–∞—è (–≥—Ä–∞–Ω–∏—Ü—ã, —Ä–µ–±—Ä–∞), –∫–∞–∫ –≤–∞–∂–Ω—ã–µ. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –ø–∏–∫—Å–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Ä–µ–±—Ä–∞, –µ–≥–æ —Ü–≤–µ—Ç –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Å–æ—Å–µ–¥–µ–π (–ª–µ–≤–æ–≥–æ –∏ –ø—Ä–∞–≤–æ–≥–æ –ø–∏–∫—Å–µ–ª–µ–π).</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/30-pixel-energy-comparison.png" alt="Pixels color difference" tabindex="0" loading="lazy"><figcaption>Pixels color difference</figcaption></figure><p>–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ —Ü–≤–µ—Ç –ø–∏–∫—Å–µ–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω <em>4-–º—è</em> —á–∏—Å–ª–∞–º–∏ (<code>R</code> - –∫—Ä–∞—Å–Ω—ã–π, <code>G</code> - –∑–µ–ª–µ–Ω—ã–π, <code>B</code> - —Å–∏–Ω–∏–π, <code>A</code> - –∞–ª—å—Ñ–∞, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å), –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ü–≤–µ—Ç–µ (—ç–Ω–µ—Ä–≥–∏–∏ –ø–∏–∫—Å–µ–ª—è):</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/20-energy-formula.png" alt="Pixel energy formula" tabindex="0" loading="lazy"><figcaption>Pixel energy formula</figcaption></figure><p>–ì–¥–µ:</p><ul><li><code>mEnergy</code> - <em>–≠–Ω–µ—Ä–≥–∏—è</em> (–≤–∞–∂–Ω–æ—Å—Ç—å) <em>—Å—Ä–µ–¥–Ω–µ–≥–æ</em> –ø–∏–∫—Å–µ–ª—è (<code>[0..626]</code> –µ—Å–ª–∏ –æ–∫—Ä—É–≥–ª–∏—Ç—å)</li><li><code>lR</code> - <em>–ö—Ä–∞—Å–Ω—ã–π</em> —Ü–≤–µ—Ç–æ–≤–æ–π –∫–∞–Ω–∞–ª <em>–ª–µ–≤–æ–≥–æ</em> –ø–∏–∫—Å–µ–ª—è (<code>[0..255]</code>)</li><li><code>mR</code> - <em>–ö—Ä–∞—Å–Ω—ã–π</em> —Ü–≤–µ—Ç–æ–≤–æ–π –∫–∞–Ω–∞–ª <em>—Å—Ä–µ–¥–Ω–µ–≥–æ</em> –ø–∏–∫—Å–µ–ª—è (<code>[0..255]</code>)</li><li><code>rR</code> - <em>–ö—Ä–∞—Å–Ω—ã–π</em> —Ü–≤–µ—Ç–æ–≤–æ–π –∫–∞–Ω–∞–ª <em>–ø—Ä–∞–≤–æ–≥–æ</em> –ø–∏–∫—Å–µ–ª—è (<code>[0..255]</code>)</li><li><code>lG</code> - <em>–ó–µ–ª–µ–Ω—ã–π</em> —Ü–≤–µ—Ç–æ–≤–æ–π –∫–∞–Ω–∞–ª <em>–ª–µ–≤–æ–≥–æ</em> –ø–∏–∫—Å–µ–ª—è (<code>[0..255]</code>)</li><li>–∏ —Ç–∞–∫ –¥–∞–ª–µ–µ...</li></ul><p>–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–π –≤—ã—à–µ —Ñ–æ—Ä–º—É–ª–µ –º—ã –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–ª—å—Ñ–∞-–∫–∞–Ω–∞–ª (–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å), –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏. –ü–æ–∑–∂–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ñ–∞-–∫–∞–Ω–∞–ª –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/30-pixel-energy-calculation-example.png" alt="Example of pixel energy calculation" tabindex="0" loading="lazy"><figcaption>Example of pixel energy calculation</figcaption></figure><p>–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –∑–Ω–∞–µ–º, –∫–∞–∫ –Ω–∞–π—Ç–∏ —ç–Ω–µ—Ä–≥–∏—é –æ–¥–Ω–æ–≥–æ –ø–∏–∫—Å–µ–ª—è, –º—ã –º–æ–∂–µ–º –≤—ã—á–∏—Å–ª–∏—Ç—å —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—É—é <strong>—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫—É—é –∫–∞—Ä—Ç—É</strong>, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —ç–Ω–µ—Ä–≥–∏–∏ –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç—É —ç–Ω–µ—Ä–≥–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å (–ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ —á–∞—Å—Ç–∏—á–Ω–æ, –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º –Ω–∏–∂–µ), –∏ –æ–Ω–∞ –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç–æ—Ç –∂–µ —Ä–∞–∑–º–µ—Ä, —á—Ç–æ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.</p><p>–ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ 1-–º —à–∞–≥–µ —É –Ω–∞—Å –±—É–¥–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º <code>1000 x 500</code> –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ —Ä–∞–∑–º–µ—Ä–æ–º <code>1000 x 500</code>. –ù–∞ 2-–º —à–∞–≥–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –º—ã —É–¥–∞–ª–∏–º —à–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ–º –∫–∞—Ä—Ç—É —ç–Ω–µ—Ä–≥–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤–æ–≥–æ —É–º–µ–Ω—å—à–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –ø–æ–ª—É—á–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º <code>999 x 500</code> –∏ –∫–∞—Ä—Ç—É —ç–Ω–µ—Ä–≥–∏–π —Ä–∞–∑–º–µ—Ä–æ–º <code>999 x 500</code>.</p><p>–ß–µ–º –≤—ã—à–µ —ç–Ω–µ—Ä–≥–∏—è –ø–∏–∫—Å–µ–ª—è, —Ç–µ–º –±–æ–ª—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Ä–µ–±—Ä–∞, –≤–∞–∂–µ–Ω –¥–ª—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç–µ–º –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –µ–≥–æ —É–¥–∞–ª–∏—Ç—å.</p><p>–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã —ç–Ω–µ—Ä–≥–∏–π –º—ã –º–æ–∂–µ–º –ø—Ä–∏—Å–≤–æ–∏—Ç—å –±–æ–ª–µ–µ —è—Ä–∫–∏–π —Ü–≤–µ—Ç –ø–∏–∫—Å–µ–ª—è–º —Å –±–æ–ª—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π –∏ –±–æ–ª–µ–µ —Ç–µ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ø–∏–∫—Å–µ–ª—è–º —Å –º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π. –í–æ—Ç –∫–∞–∫ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —á–∞—Å—Ç—å –∫–∞—Ä—Ç—ã —ç–Ω–µ—Ä–≥–∏–π. –í—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å —Å–≤–µ—Ç–ª—É—é –ª–∏–Ω–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫—Ä–∞–π –∏ –∫–æ—Ç–æ—Ä—É—é –º—ã —Ö–æ—Ç–∏–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/30-energy-map-padding.png" alt="Energy map sketch" tabindex="0" loading="lazy"><figcaption>Energy map sketch</figcaption></figure><p>–í–æ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç—ã –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã –≤–∏–¥–µ–ª–∏ –≤—ã—à–µ (—Å –≤–æ–∑–¥—É—à–Ω—ã–º–∏ —à–∞—Ä–∞–º–∏).</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/40-energy-map.png" alt="Energy map example" tabindex="0" loading="lazy"><figcaption>Energy map example</figcaption></figure><p>–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –≤ <a href="https://trekhleb.dev/blog/2021/content-aware-image-resizing-in-javascript/" target="_blank" rel="noopener noreferrer">–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —Å—Ç–∞—Ç—å–∏<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>–ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫—É—é –∫–∞—Ä—Ç—É, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —à–≤—ã (–æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º) —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π –∏ —Ç–µ–º —Å–∞–º—ã–º —Ä–µ—à–∏—Ç—å, –∫–∞–∫–∏–µ –ø–∏–∫—Å–µ–ª–∏ –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/41-seam-search.png" alt="Searching the seam" tabindex="0" loading="lazy"><figcaption>Searching the seam</figcaption></figure><p>–ü–æ–∏—Å–∫ —à–≤–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–∞—á–µ–π –∏ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–±–æ—Ä–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –ø–∏–∫—Å–µ–ª–µ–π. –ú—ã –ø—Ä–∏–º–µ–Ω–∏–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ —à–≤–∞.</p><p>–í –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –∫–∞—Ä—Ç—É —ç–Ω–µ—Ä–≥–∏–π —Å –ø–µ—Ä–≤—ã–º –Ω–∞–π–¥–µ–Ω–Ω—ã–º –¥–ª—è –Ω–µ–µ —à–≤–æ–º —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/40-energy-map-with-seam.png" alt="Energy map example with seam" tabindex="0" loading="lazy"><figcaption>Energy map example with seam</figcaption></figure><p>–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–∞—Ö –º—ã —É–º–µ–Ω—å—à–∞–ª–∏ —à–∏—Ä–∏–Ω—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –≤—ã—Å–æ—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ:</p><ul><li>–Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Å–µ–¥–µ–π <em>—Å–≤–µ—Ä—Ö—É</em> –∏ <em>—Å–Ω–∏–∑—É</em>, –∞ –Ω–µ <em>—Å–ª–µ–≤–∞</em> –∏ <em>—Å–ø—Ä–∞–≤–∞</em>, –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –ø–∏–∫—Å–µ–ª—è</li><li>–ø—Ä–∏ –ø–æ–∏—Å–∫–µ —à–≤–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è <em>—Å–ª–µ–≤–∞</em> <em>–Ω–∞–ø—Ä–∞–≤–æ</em>, –∞ –Ω–µ <em>—Å–≤–µ—Ä—Ö—É</em> <em>–≤–Ω–∏–∑</em>.</li></ul><h2 id="—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-–Ω–∞-typescript" tabindex="-1"><a class="header-anchor" href="#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-–Ω–∞-typescript" aria-hidden="true">#</a> –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ TypeScript</h2><blockquote><p>–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –∏ —Ñ—É–Ω–∫—Ü–∏–∏, —É–ø–æ–º—è–Ω—É—Ç—ã–µ –Ω–∏–∂–µ, –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ <a href="https://github.com/trekhleb/js-image-carver" target="_blank" rel="noopener noreferrer">js-image-carver<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></blockquote><p>–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TypeScript. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞ JavaScript, –≤—ã –º–æ–∂–µ—Ç–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (—É–¥–∞–ª–∏—Ç—å) –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –∏ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.</p><p>–î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø—Ä–∏–º–µ—Ä–æ–≤ –º—ã –Ω–∞–ø–∏—à–µ–º –∫–æ–¥ —Ç–æ–ª—å–∫–æ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è <em>—à–∏—Ä–∏–Ω—ã</em> –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p><h3 id="—É–º–µ–Ω—å—à–µ–Ω–∏–µ-—à–∏—Ä–∏–Ω—ã-—Å-—É—á–µ—Ç–æ–º-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è-–∏—Å—Ö–æ–¥–Ω–∞—è-—Ñ—É–Ω–∫—Ü–∏—è" tabindex="-1"><a class="header-anchor" href="#—É–º–µ–Ω—å—à–µ–Ω–∏–µ-—à–∏—Ä–∏–Ω—ã-—Å-—É—á–µ—Ç–æ–º-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è-–∏—Å—Ö–æ–¥–Ω–∞—è-—Ñ—É–Ω–∫—Ü–∏—è" aria-hidden="true">#</a> –£–º–µ–Ω—å—à–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã —Å —É—á–µ—Ç–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∏—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)</h3><p>–î–ª—è –Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–±—â–∏–µ —Ç–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// Type that describes the image size (width and height).</span>
<span class="token keyword">type</span> <span class="token class-name">ImageSize</span> <span class="token operator">=</span> <span class="token punctuation">{</span> w<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> h<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// The coordinate of the pixel.</span>
<span class="token keyword">type</span> <span class="token class-name">Coordinate</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// The seam is a sequence of pixels (coordinates).</span>
<span class="token keyword">type</span> <span class="token class-name">Seam</span> <span class="token operator">=</span> Coordinate<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Energy map is a 2D array that has the same width and height</span>
<span class="token comment">// as the image the map is being calculated for.</span>
<span class="token keyword">type</span> <span class="token class-name">EnergyMap</span> <span class="token operator">=</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Type that describes the image pixel&#39;s RGBA color.</span>
<span class="token keyword">type</span> <span class="token class-name">Color</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  r<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token comment">// Red</span>
  g<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token comment">// Green</span>
  b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token comment">// Blue</span>
  a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token comment">// Alpha (transparency)</span>
<span class="token punctuation">]</span> <span class="token operator">|</span> Uint8ClampedArray<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>–î–ª—è –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:</p><ol><li>–†–∞—Å—Å—á–∏—Ç–∞—Ç—å <strong>–∫–∞—Ä—Ç—É —ç–Ω–µ—Ä–≥–∏–∏</strong> –¥–ª—è —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.</li><li>–ù–∞–π—Ç–∏ <strong>—à–æ–≤</strong> —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—Ä—Ç—ã —ç–Ω–µ—Ä–≥–∏–π (–∑–¥–µ—Å—å –º—ã –ø—Ä–∏–º–µ–Ω–∏–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ).</li><li><strong>–£–¥–∞–ª–∏—Ç—å —à–æ–≤</strong> —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.</li><li><strong>–ü–æ–≤—Ç–æ—Ä—è—Ç—å</strong> –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —à–∏—Ä–∏–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –±—É–¥–µ—Ç —É–º–µ–Ω—å—à–µ–Ω–∞ –¥–æ –Ω—É–∂–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.</li></ol><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">ResizeImageWidthArgs</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  img<span class="token operator">:</span> ImageData<span class="token punctuation">,</span> <span class="token comment">// Image data we want to resize.</span>
  toWidth<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token comment">// Final image width we want the image to shrink to.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">ResizeImageWidthResult</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  img<span class="token operator">:</span> ImageData<span class="token punctuation">,</span> <span class="token comment">// Resized image data.</span>
  size<span class="token operator">:</span> ImageSize<span class="token punctuation">,</span> <span class="token comment">// Resized image size (w x h).</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Performs the content-aware image width resizing using the seam carving method.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> resizeImageWidth <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token punctuation">{</span> img<span class="token punctuation">,</span> toWidth <span class="token punctuation">}</span><span class="token operator">:</span> ResizeImageWidthArgs<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ResizeImageWidthResult <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// For performance reasons we want to avoid changing the img data array size.</span>
  <span class="token comment">// Instead we&#39;ll just keep the record of the resized image width and height separately.</span>
  <span class="token keyword">const</span> size<span class="token operator">:</span> ImageSize <span class="token operator">=</span> <span class="token punctuation">{</span> w<span class="token operator">:</span> img<span class="token punctuation">.</span>width<span class="token punctuation">,</span> h<span class="token operator">:</span> img<span class="token punctuation">.</span>height <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Calculating the number of pixels to remove.</span>
  <span class="token keyword">const</span> pxToRemove <span class="token operator">=</span> img<span class="token punctuation">.</span>width <span class="token operator">-</span> toWidth<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>pxToRemove <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;Upsizing is not supported for now&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> energyMap<span class="token operator">:</span> EnergyMap <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> seam<span class="token operator">:</span> Seam <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">// Removing the lowest energy seams one by one.</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pxToRemove<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. Calculate the energy map for the current version of the image.</span>
    energyMap <span class="token operator">=</span> <span class="token function">calculateEnergyMap</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. Find the seam with the lowest energy based on the energy map.</span>
    seam <span class="token operator">=</span> <span class="token function">findLowEnergySeam</span><span class="token punctuation">(</span>energyMap<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. Delete the seam with the lowest energy seam from the image.</span>
    <span class="token function">deleteSeam</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> seam<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Reduce the image width, and continue iterations.</span>
    size<span class="token punctuation">.</span>w <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Returning the resized image and its final size.</span>
  <span class="token comment">// The img is actually a reference to the ImageData, so technically</span>
  <span class="token comment">// the caller of the function already has this pointer. But let&#39;s</span>
  <span class="token comment">// still return it for better code readability.</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> img<span class="token punctuation">,</span> size <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é –≤ —Ñ–æ—Ä–º–∞—Ç–µ <a href="https://developer.mozilla.org/en-US/docs/Web/API/ImageData" target="_blank" rel="noopener noreferrer">ImageData<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ canvas-–µ, –∞ –∑–∞—Ç–µ–º –∏–∑–≤–ª–µ—á—å ImageData –∏–∑ —Ç–æ–≥–æ –∂–µ canvas-–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> imgData <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> imgWidth<span class="token punctuation">,</span> imgHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ JavaScript –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–∏, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –ø–æ–ª–Ω—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Ç–æ–≥–æ, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é React –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ <a href="https://github.com/trekhleb/js-image-carver" target="_blank" rel="noopener noreferrer">js-image-carver<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></blockquote><p>–¢–µ–ø–µ—Ä—å, –ø–æ—à–∞–≥–æ–≤–æ —Ä–µ–∞–ª–∏–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ <code>calculateEnergyMap()</code>, <code>findLowEnergySeam()</code> –∏ <code>deleteSeam()</code>.</p><h3 id="—Ä–∞—Å—á–µ—Ç-—ç–Ω–µ—Ä–≥–∏–∏-–ø–∏–∫—Å–µ–ª—è" tabindex="-1"><a class="header-anchor" href="#—Ä–∞—Å—á–µ—Ç-—ç–Ω–µ—Ä–≥–∏–∏-–ø–∏–∫—Å–µ–ª—è" aria-hidden="true">#</a> –†–∞—Å—á–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏ –ø–∏–∫—Å–µ–ª—è</h3><p>–î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —Ñ–æ—Ä–º—É–ª–æ–π —Ä–∞–∑–Ω–∏—Ü—ã —Ü–≤–µ—Ç–æ–≤, –æ–ø–∏—Å–∞–Ω–Ω–æ–π –≤—ã—à–µ. –î–ª—è –ª–µ–≤–æ–π –∏ –ø—Ä–∞–≤–æ–π –∫—Ä–∞–µ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∫–æ–≥–¥–∞ –Ω–µ—Ç –ª–µ–≤–æ–≥–æ –∏–ª–∏ –ø—Ä–∞–≤–æ–≥–æ —Å–æ—Å–µ–¥–µ–π) –º—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ—Å–µ–¥–µ–π –∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ–º –∏—Ö –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —ç–Ω–µ—Ä–≥–∏–∏.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// Calculates the energy of a pixel.</span>
<span class="token keyword">const</span> getPixelEnergy <span class="token operator">=</span> <span class="token punctuation">(</span>left<span class="token operator">:</span> Color <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> middle<span class="token operator">:</span> Color<span class="token punctuation">,</span> right<span class="token operator">:</span> Color <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Middle pixel is the pixel we&#39;re calculating the energy for.</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>mR<span class="token punctuation">,</span> mG<span class="token punctuation">,</span> mB<span class="token punctuation">]</span> <span class="token operator">=</span> middle<span class="token punctuation">;</span>

  <span class="token comment">// Energy from the left pixel (if it exists).</span>
  <span class="token keyword">let</span> lEnergy <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>left<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>lR<span class="token punctuation">,</span> lG<span class="token punctuation">,</span> lB<span class="token punctuation">]</span> <span class="token operator">=</span> left<span class="token punctuation">;</span>
    lEnergy <span class="token operator">=</span> <span class="token punctuation">(</span>lR <span class="token operator">-</span> mR<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>lG <span class="token operator">-</span> mG<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>lB <span class="token operator">-</span> mB<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Energy from the right pixel (if it exists).</span>
  <span class="token keyword">let</span> rEnergy <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>rR<span class="token punctuation">,</span> rG<span class="token punctuation">,</span> rB<span class="token punctuation">]</span> <span class="token operator">=</span> right<span class="token punctuation">;</span>
    rEnergy <span class="token operator">=</span> <span class="token punctuation">(</span>rR <span class="token operator">-</span> mR<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>rG <span class="token operator">-</span> mG<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>rB <span class="token operator">-</span> mB<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Resulting pixel energy.</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>lEnergy <span class="token operator">+</span> rEnergy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="—Ä–∞—Å—á–µ—Ç-—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–∏-–∫–∞—Ä—Ç—ã" tabindex="-1"><a class="header-anchor" href="#—Ä–∞—Å—á–µ—Ç-—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–∏-–∫–∞—Ä—Ç—ã" aria-hidden="true">#</a> –†–∞—Å—á–µ—Ç —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç—ã</h3><p>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã —Ä–∞–±–æ—Ç–∞–µ–º, –∏–º–µ–µ—Ç —Ñ–æ—Ä–º–∞—Ç <a href="https://developer.mozilla.org/en-US/docs/Web/API/ImageData" target="_blank" rel="noopener noreferrer">ImageData<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏ (–∏ –∏—Ö —Ü–≤–µ—Ç–∞) —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–º –º–∞—Å—Å–∏–≤–µ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray" target="_blank" rel="noopener noreferrer">Uint8ClampedArray<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è –≤–≤–µ–¥–µ–º –ø–∞—Ä—É –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º–∞—Å—Å–∏–≤–æ–º Uint8ClampedArray –∫–∞–∫ —Å <em>2D</em> –º–∞—Ç—Ä–∏—Ü–µ–π.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// Helper function that returns the color of the pixel.</span>
<span class="token keyword">const</span> getPixel <span class="token operator">=</span> <span class="token punctuation">(</span>img<span class="token operator">:</span> ImageData<span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token operator">:</span> Coordinate<span class="token punctuation">)</span><span class="token operator">:</span> Color <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// The ImageData data array is a flat 1D array.</span>
  <span class="token comment">// Thus we need to convert x and y coordinates to the linear index.</span>
  <span class="token keyword">const</span> i <span class="token operator">=</span> y <span class="token operator">*</span> img<span class="token punctuation">.</span>width <span class="token operator">+</span> x<span class="token punctuation">;</span>
  <span class="token keyword">const</span> cellsPerColor <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// RGBA</span>
  <span class="token comment">// For better efficiency, instead of creating a new sub-array we return</span>
  <span class="token comment">// a pointer to the part of the ImageData array.</span>
  <span class="token keyword">return</span> img<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>i <span class="token operator">*</span> cellsPerColor<span class="token punctuation">,</span> i <span class="token operator">*</span> cellsPerColor <span class="token operator">+</span> cellsPerColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Helper function that sets the color of the pixel.</span>
<span class="token keyword">const</span> setPixel <span class="token operator">=</span> <span class="token punctuation">(</span>img<span class="token operator">:</span> ImageData<span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token operator">:</span> Coordinate<span class="token punctuation">,</span> color<span class="token operator">:</span> Color<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// The ImageData data array is a flat 1D array.</span>
  <span class="token comment">// Thus we need to convert x and y coordinates to the linear index.</span>
  <span class="token keyword">const</span> i <span class="token operator">=</span> y <span class="token operator">*</span> img<span class="token punctuation">.</span>width <span class="token operator">+</span> x<span class="token punctuation">;</span>
  <span class="token keyword">const</span> cellsPerColor <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// RGBA</span>
  img<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>color<span class="token punctuation">,</span> i <span class="token operator">*</span> cellsPerColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–∞—Ä—Ç—ã —ç–Ω–µ—Ä–≥–∏–∏ –º—ã –ø—Ä–æ—Ö–æ–¥–∏–º —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–π –ø–∏–∫—Å–µ–ª—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –≤—ã–∑—ã–≤–∞–µ–º –¥–ª—è –Ω–µ–≥–æ –æ–ø–∏—Å–∞–Ω–Ω—É—é —Ä–∞–Ω–µ–µ —Ñ—É–Ω–∫—Ü–∏—é <code>getPixelEnergy()</code>.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// Helper function that creates a matrix (2D array) of specific</span>
<span class="token comment">// size (w x h) and fills it with specified value.</span>
<span class="token keyword">const</span> matrix <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>w<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> h<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> filler<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Array</span></span><span class="token punctuation">(</span>h<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Array</span></span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>filler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Calculates the energy of each pixel of the image.</span>
<span class="token keyword">const</span> calculateEnergyMap <span class="token operator">=</span> <span class="token punctuation">(</span>img<span class="token operator">:</span> ImageData<span class="token punctuation">,</span> <span class="token punctuation">{</span> w<span class="token punctuation">,</span> h <span class="token punctuation">}</span><span class="token operator">:</span> ImageSize<span class="token punctuation">)</span><span class="token operator">:</span> EnergyMap <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Create an empty energy map where each pixel has infinitely high energy.</span>
  <span class="token comment">// We will update the energy of each pixel.</span>
  <span class="token keyword">const</span> energyMap<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">matrix</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> <span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> h<span class="token punctuation">;</span> y <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> w<span class="token punctuation">;</span> x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Left pixel might not exist if we&#39;re on the very left edge of the image.</span>
      <span class="token keyword">const</span> left <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token function">getPixel</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token comment">// The color of the middle pixel that we&#39;re calculating the energy for.</span>
      <span class="token keyword">const</span> middle <span class="token operator">=</span> <span class="token function">getPixel</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Right pixel might not exist if we&#39;re on the very right edge of the image.</span>
      <span class="token keyword">const</span> right <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> w <span class="token operator">?</span> <span class="token function">getPixel</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      energyMap<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getPixelEnergy</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> energyMap<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>–ö–∞—Ä—Ç–∞ —ç–Ω–µ—Ä–≥–∏–∏ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –æ–Ω–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è, —Å–∫–∞–∂–µ–º, 500 —Ä–∞–∑, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ 500 –ø–∏–∫—Å–µ–ª–µ–π, —á—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ. –ß—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ 2-–º, 3-–º –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–∞—Ö, –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —ç–Ω–µ—Ä–≥–∏—é —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤–æ–∫—Ä—É–≥ —à–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω. –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —ç—Ç–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–¥–µ—Å—å –ø—Ä–æ–ø—É—â–µ–Ω–∞, –Ω–æ –ø—Ä–∏–º–µ—Ä —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ <a href="https://github.com/trekhleb/js-image-carver" target="_blank" rel="noopener noreferrer">js-image-carver<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></blockquote><h3 id="–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ-—à–≤–∞-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–∏-—ç–Ω–µ—Ä–≥–∏–µ–∏-–ø—Ä–∏–º–µ–Ω—è–µ–º-–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" tabindex="-1"><a class="header-anchor" href="#–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ-—à–≤–∞-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–∏-—ç–Ω–µ—Ä–≥–∏–µ–∏-–ø—Ä–∏–º–µ–Ω—è–µ–º-–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" aria-hidden="true">#</a> –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ —à–≤–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π (–ø—Ä–∏–º–µ–Ω—è–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)</h3><blockquote><p>–í —Å—Ç–∞—Ç—å–µ <a href="https://trekhleb.dev/blog/2018/dynamic-programming-vs-divide-and-conquer/" target="_blank" rel="noopener noreferrer">Dynamic Programming vs Divide-and-Conquer<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> —è –æ–ø–∏—Å—ã–≤–∞–ª –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞—Å–ø–µ–∫—Ç—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è &quot;—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞&quot; (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –¥—Ä—É–≥—É—é). –í–æ–∑–º–æ–∂–Ω–æ –æ–Ω–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞ –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è.</p></blockquote><p>–ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ—à–∏—Ç—å –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ –ø—É—Ç–∏ (—à–≤–∞) –Ω–∞ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –∏–¥–µ—Ç –æ—Ç –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫ –Ω–∏–∂–Ω–µ–π –∏ –∏–º–µ–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é (—Å—É–º–º–∞ —ç–Ω–µ—Ä–≥–∏–π –ø–∏–∫—Å–µ–ª–µ–π, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö —à–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π).</p><h4 id="–Ω–∞–∏–≤–Ω—ã–∏-–ø–æ–¥—Ö–æ–¥-naive" tabindex="-1"><a class="header-anchor" href="#–Ω–∞–∏–≤–Ω—ã–∏-–ø–æ–¥—Ö–æ–¥-naive" aria-hidden="true">#</a> &quot;–ù–∞–∏–≤–Ω—ã–π&quot; –ø–æ–¥—Ö–æ–¥ (naive)</h4><p>–ü—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω—ã–π (&quot;–Ω–∞–∏–≤–Ω—ã–π&quot;) –ø–æ–¥—Ö–æ–¥ ‚Äî –ø–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏ –æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/50-naive-approach.png" alt="The naive approach" tabindex="0" loading="lazy"><figcaption>The naive approach</figcaption></figure><p>–î–≤–∏–≥–∞—è—Å—å —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è —É –Ω–∞—Å –µ—Å—Ç—å 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ (‚ÜôÔ∏é –∏–¥—Ç–∏ –≤–Ω–∏–∑-–≤–ª–µ–≤–æ, ‚Üì –≤–Ω–∏–∑, ‚ÜòÔ∏é –∏–¥—Ç–∏ –≤–Ω–∏–∑-–≤–ø—Ä–∞–≤–æ). –≠—Ç–æ –¥–∞–µ—Ç –Ω–∞–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å <code>O (w * 3 ^ h)</code> –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ <code>O (3 ^ h)</code>, –≥–¥–µ <code>w</code> –∏<code> h</code> - —à–∏—Ä–∏–Ω–∞ –∏ –≤—ã—Å–æ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º.</p><h4 id="–∂–∞–¥–Ω—ã–∏-–ø–æ–¥—Ö–æ–¥-greedy" tabindex="-1"><a class="header-anchor" href="#–∂–∞–¥–Ω—ã–∏-–ø–æ–¥—Ö–æ–¥-greedy" aria-hidden="true">#</a> &quot;–ñ–∞–¥–Ω—ã–π&quot; –ø–æ–¥—Ö–æ–¥ (greedy)</h4><p>–ñ–∞–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî –≤—ã–±–∏—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø–∏–∫—Å–µ–ª—å –∫–∞–∫ –ø–∏–∫—Å–µ–ª—å —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π, –Ω–∞–¥–µ—è—Å—å, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è —ç–Ω–µ—Ä–≥–∏—è —à–≤–∞ –±—É–¥–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–µ–π.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/51-greedy-approach.png" alt="The greedy approach" tabindex="0" loading="lazy"><figcaption>The greedy approach</figcaption></figure><p>–ñ–∞–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø—Ä–∏–≤–µ–¥–µ—Ç –Ω–∞—Å –∫ –Ω–µ —Å–∞–º–æ–º—É —Ö—É–¥—à–µ–º—É —Ä–µ—à–µ–Ω–∏—é, –Ω–æ –æ–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –º—ã –Ω–∞–π–¥–µ–º –Ω–∞–∏–ª—É—á—à–µ–µ –¥–æ—Å—Ç—É–ø–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –≤—ã—à–µ –≤–∏–¥–Ω–æ, –∫–∞–∫ –º—ã –≤—ã–±—Ä–∞–ª–∏ <code>5</code> –≤–º–µ—Å—Ç–æ <code>10</code> –∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ —Ü–µ–ø–æ—á–∫—É –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π.</p><p>–ü–ª—é—Å —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω –±—ã—Å—Ç—Ä—ã–π –∏ –∏–º–µ–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å <code>O(w + h)</code>, –≥–¥–µ <code>w</code> –∏ <code>h</code> - —ç—Ç–æ —à–∏—Ä–∏–Ω–∞ –∏ –≤—ã—Å–æ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–ª–∞—Ç–∞ –∑–∞ —Å–∫–æ—Ä–æ—Å—Ç—å ‚Äî –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ—Å–∞–π–∑–∞ (–º–Ω–æ–≥–æ –∏—Å–∫–∞–∂–µ–Ω–∏–π). –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–∞ —Ç–µ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–µ—Ä–≤–æ–º —Ä—è–¥—É (–æ–±—Ö–æ–¥ <code>w</code> —è—á–µ–µ–∫), –∞ –∑–∞—Ç–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ 3 —Å–æ—Å–µ–¥–Ω–∏—Ö –ø–∏–∫—Å–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä—è–¥–∞ (–æ–±—Ö–æ–¥ <code>h</code> —Ä—è–¥–æ–≤).</p><h4 id="–∏—Å–ø–æ–ª—å–∑—É–µ–º-–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" tabindex="-1"><a class="header-anchor" href="#–∏—Å–ø–æ–ª—å–∑—É–µ–º-–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" aria-hidden="true">#</a> –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</h4><p>–í—ã, –Ω–∞–≤–µ—Ä–Ω–æ–µ, –∑–∞–º–µ—Ç–∏–ª–∏, —á—Ç–æ –≤ –Ω–∞–∏–≤–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –º—ã —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞ —Å—É–º–º–∏—Ä–æ–≤–∞–ª–∏ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —ç–Ω–µ—Ä–≥–∏–∏ –ø–∏–∫—Å–µ–ª–µ–π, –≤—ã—á–∏—Å–ª—è—è —ç–Ω–µ—Ä–≥–∏—é –æ–±—Ä–∞–∑–æ–≤–∞–≤—à–∏—Ö—Å—è —à–≤–æ–≤.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/52-dp-repeated-problems.png" alt="Repeated problems" tabindex="0" loading="lazy"><figcaption>Repeated problems</figcaption></figure><p>–í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –≤–∏–¥–Ω–æ, —á—Ç–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö —à–≤–æ–≤ –º—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç–Ω–µ—Ä–≥–∏—é –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ —à–≤–∞ (–∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç —ç–Ω–µ—Ä–≥–∏—é <code>235</code>). –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ <code>235 + 70</code> –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ 2-–≥–æ —à–≤–∞ –º—ã –¥–µ–ª–∞–µ–º —á–µ—Ç—ã—Ä–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ <code>(5 + 0 + 80 + 150) + 70</code>.</p><blockquote><p>–¢–æ—Ç —Ñ–∞–∫—Ç, —á—Ç–æ –º—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç–Ω–µ—Ä–≥–∏—é –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–≤–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ —à–≤–∞, –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∫–æ –≤—Å–µ–º –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–º —à–≤–∞–º –¥–æ —Å–∞–º–æ–≥–æ –≤–µ—Ä—Ö–Ω–µ–≥–æ 1-–≥–æ —Ä—è–¥–∞. –ö–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å —Ç–∞–∫–∏–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è –ø–æ–¥-–ø—Ä–æ–±–ª–µ–º—ã, <a href="https://trekhleb.dev/blog/2018/dynamic-programming-vs-divide-and-conquer/" target="_blank" rel="noopener noreferrer">—ç—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, —á—Ç–æ –æ–±—â–∞—è –∑–∞–¥–∞—á–∞ <em>–º–æ–∂–µ—Ç</em> –±—ã—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.</p></blockquote><p>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º <strong>—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç–Ω–µ—Ä–≥–∏—é —Ç–µ–∫—É—â–µ–≥–æ —à–≤–∞</strong> –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∏–∫—Å–µ–ª—è –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ <code>samsEnergies</code>, —á—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–µ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —ç–Ω–µ—Ä–≥–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —à–≤–æ–≤ (—Ç–∞–±–ª–∏—Ü–∞ <code>samsEnergies</code> –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç–æ—Ç –∂–µ —Ä–∞–∑–º–µ—Ä, —á—Ç–æ –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –∏ —Å–∞–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ).</p><p>–û–±—Ä–∞—Ç–∏—Ç–µ —Ç–∞–∫–∂–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–∏–∫—Å–µ–ª–µ–π –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ª–µ–≤–æ–≥–æ –Ω–∏–∂–Ω–µ–≥–æ) –º—ã –º–æ–∂–µ–º –∏–º–µ—Ç—å <em>–Ω–µ—Å–∫–æ–ª—å–∫–æ</em> –∑–Ω–∞—á–µ–Ω–∏–π —ç–Ω–µ—Ä–≥–∏–π –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —à–≤–æ–≤.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/53-dp-what-to-choose.png" alt="What seam to choose" tabindex="0" loading="lazy"><figcaption>What seam to choose</figcaption></figure><p>–¢–∞–∫ –∫–∞–∫ –º—ã –∏—â–µ–º —à–æ–≤ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π, –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –≤—ã–±–∏—Ä–∞—Ç—å –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —à–æ–≤ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/56-dp-seams-energies-example.png" alt="Seams energies example" tabindex="0" loading="lazy"><figcaption>Seams energies example</figcaption></figure><p>–ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —É –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —à–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–∫—É—â–∏–π –ø–∏–∫—Å–µ–ª—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç:</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/55-dp-three-options.png" alt="Three options to choose from" tabindex="0" loading="lazy"><figcaption>Three options to choose from</figcaption></figure><p>–ú–æ–∂–µ–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —ç—Ç–æ —Å —Ç–∞–∫–æ–π —Å—Ç–æ—Ä–æ–Ω—ã:</p><ul><li>–Ø—á–µ–π–∫–∞ <code>[1][x]</code>: —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∏–º–µ–Ω—å—à—É—é –≤–æ–∑–º–æ–∂–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é —à–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≥–¥–µ-—Ç–æ –≤ —Ä—è–¥—É <code>[0][?] </code> –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤ —è—á–µ–π–∫–µ <code>[1][x]</code>.</li><li><strong>–¢–µ–∫—É—â–∞—è —è—á–µ–π–∫–∞</strong> <code>[2][3]</code>: —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∏–º–µ–Ω—å—à—É—é –≤–æ–∑–º–æ–∂–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é —à–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≥–¥–µ-—Ç–æ –≤ —Ä—è–¥—É <code>[0][?] </code> –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤ —è—á–µ–π–∫–µ <code>[2][3]</code>. –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å —ç–Ω–µ—Ä–≥–∏—é —Ç–µ–∫—É—â–µ–≥–æ –ø–∏–∫—Å–µ–ª—è <code>[2][3]</code> (–∏–∑ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç—ã) —Å <code>min(seam_energy_1_2, seam_energy_1_3, seam_energy_1_4)</code>.</li></ul><p>–ï—Å–ª–∏ –º—ã –∑–∞–ø–æ–ª–Ω–∏–º —Ç–∞–±–ª–∏—Ü—É <code>ShesamsEnergies</code> –ø–æ–ª–Ω–æ—Å—Ç—å—é, —Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –≤ –Ω–∏–∂–Ω–µ–º —Ä—è–¥—É –±—É–¥–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–µ–π –≤–æ–∑–º–æ–∂–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π —à–≤–∞.</p><p>–ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —è—á–µ–µ–∫ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/57-dp-seams-energies-traversal.png" alt="Seams energies map traversal" tabindex="0" loading="lazy"><figcaption>Seams energies map traversal</figcaption></figure><p>–ü–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã <code>ShesamsEnergies</code> –≤–∏–¥–Ω–æ, —á—Ç–æ –≤ –Ω–∏–∂–Ω–µ–º —Ä—è–¥—É –ø–∏–∫—Å–µ–ª—å —Å —Å–∞–º–æ–π –Ω–∏–∑–∫–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ <code>50</code>. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ <code>samsEnergies</code> –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è –º—ã –º–æ–∂–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —ç–Ω–µ—Ä–≥–∏—é —à–≤–∞, –Ω–æ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–≤–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —ç–Ω–µ—Ä–≥–∏–µ–π. –≠—Ç–æ –¥–∞—Å—Ç –Ω–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª–µ–≥–∫–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é —à–≤–∞ —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö.</p><p>–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å DP –ø–æ–¥—Ö–æ–¥–∞ —Å–æ—Å—Ç–∞–≤–∏—Ç <code>O(w * h)</code>, –≥–¥–µ <code>w</code> –∏ <code>h</code> - —ç—Ç–æ —à–∏—Ä–∏–Ω–∞ –∏ –≤—ã—Å–æ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –û–±—É—Å–ª–æ–≤–ª–µ–Ω–∞ –æ–Ω–∞ —Ç–µ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è <em>–≤—Å–µ—Ö</em> –ø–∏–∫—Å–µ–ª–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p><p>–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ —ç—Ç–∞ –ª–æ–≥–∏–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// The metadata for the pixels in the seam.</span>
<span class="token keyword">type</span> <span class="token class-name">SeamPixelMeta</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  energy<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token comment">// The energy of the pixel.</span>
  coordinate<span class="token operator">:</span> Coordinate<span class="token punctuation">,</span> <span class="token comment">// The coordinate of the pixel.</span>
  previous<span class="token operator">:</span> Coordinate <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// The previous pixel in a seam.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Finds the seam (the sequence of pixels from top to bottom) that has the</span>
<span class="token comment">// lowest resulting energy using the Dynamic Programming approach.</span>
<span class="token keyword">const</span> findLowEnergySeam <span class="token operator">=</span> <span class="token punctuation">(</span>energyMap<span class="token operator">:</span> EnergyMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> w<span class="token punctuation">,</span> h <span class="token punctuation">}</span><span class="token operator">:</span> ImageSize<span class="token punctuation">)</span><span class="token operator">:</span> Seam <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// The 2D array of the size of w and h, where each pixel contains the</span>
  <span class="token comment">// seam metadata (pixel energy, pixel coordinate and previous pixel from</span>
  <span class="token comment">// the lowest energy seam at this point).</span>
  <span class="token keyword">const</span> seamsEnergies<span class="token operator">:</span> <span class="token punctuation">(</span>SeamPixelMeta <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">matrix</span><span class="token generic class-name"><span class="token operator">&lt;</span>SeamPixelMeta <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Populate the first row of the map by just copying the energies</span>
  <span class="token comment">// from the energy map.</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> w<span class="token punctuation">;</span> x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    seamsEnergies<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      energy<span class="token operator">:</span> energyMap<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span>
      coordinate<span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">,</span>
      previous<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Populate the rest of the rows.</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> h<span class="token punctuation">;</span> y <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> w<span class="token punctuation">;</span> x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Find the top adjacent cell with minimum energy.</span>
      <span class="token comment">// This cell would be the tail of a seam with lowest energy at this point.</span>
      <span class="token comment">// It doesn&#39;t mean that this seam (path) has lowest energy globally.</span>
      <span class="token comment">// Instead, it means that we found a path with the lowest energy that may lead</span>
      <span class="token comment">// us to the current pixel with the coordinates x and y.</span>
      <span class="token keyword">let</span> minPrevEnergy <span class="token operator">=</span> <span class="token number">Infinity</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> minPrevX<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> w <span class="token operator">&amp;&amp;</span> seamsEnergies<span class="token punctuation">[</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>energy <span class="token operator">&lt;</span> minPrevEnergy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          minPrevEnergy <span class="token operator">=</span> seamsEnergies<span class="token punctuation">[</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>energy<span class="token punctuation">;</span>
          minPrevX <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Update the current cell.</span>
      seamsEnergies<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        energy<span class="token operator">:</span> minPrevEnergy <span class="token operator">+</span> energyMap<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span>
        coordinate<span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">,</span>
        previous<span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> minPrevX<span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Find where the minimum energy seam ends.</span>
  <span class="token comment">// We need to find the tail of the lowest energy seam to start</span>
  <span class="token comment">// traversing it from its tail to its head (from the bottom to the top).</span>
  <span class="token keyword">let</span> lastMinCoordinate<span class="token operator">:</span> Coordinate <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> minSeamEnergy <span class="token operator">=</span> <span class="token number">Infinity</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> w<span class="token punctuation">;</span> x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> h <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>seamsEnergies<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>energy <span class="token operator">&lt;</span> minSeamEnergy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      minSeamEnergy <span class="token operator">=</span> seamsEnergies<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>energy<span class="token punctuation">;</span>
      lastMinCoordinate <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Find the lowest energy energy seam.</span>
  <span class="token comment">// Once we know where the tail is we may traverse and assemble the lowest</span>
  <span class="token comment">// energy seam based on the &quot;previous&quot; value of the seam pixel metadata.</span>
  <span class="token keyword">const</span> seam<span class="token operator">:</span> Seam <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>lastMinCoordinate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> seam<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> lastMinX<span class="token punctuation">,</span> y<span class="token operator">:</span> lastMinY <span class="token punctuation">}</span> <span class="token operator">=</span> lastMinCoordinate<span class="token punctuation">;</span>

  <span class="token comment">// Adding new pixel to the seam path one by one until we reach the top.</span>
  <span class="token keyword">let</span> currentSeam <span class="token operator">=</span> seamsEnergies<span class="token punctuation">[</span>lastMinY<span class="token punctuation">]</span><span class="token punctuation">[</span>lastMinX<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>currentSeam<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    seam<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>currentSeam<span class="token punctuation">.</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> prevMinCoordinates <span class="token operator">=</span> currentSeam<span class="token punctuation">.</span>previous<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>prevMinCoordinates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      currentSeam <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> prevMinX<span class="token punctuation">,</span> y<span class="token operator">:</span> prevMinY <span class="token punctuation">}</span> <span class="token operator">=</span> prevMinCoordinates<span class="token punctuation">;</span>
      currentSeam <span class="token operator">=</span> seamsEnergies<span class="token punctuation">[</span>prevMinY<span class="token punctuation">]</span><span class="token punctuation">[</span>prevMinX<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> seam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="—É–¥–∞–ª–µ–Ω–∏–µ-—à–≤–∞-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–∏-—ç–Ω–µ—Ä–≥–∏–µ–∏" tabindex="-1"><a class="header-anchor" href="#—É–¥–∞–ª–µ–Ω–∏–µ-—à–≤–∞-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–∏-—ç–Ω–µ—Ä–≥–∏–µ–∏" aria-hidden="true">#</a> –£–¥–∞–ª–µ–Ω–∏–µ —à–≤–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π</h3><p>–ö–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –Ω–∞—à–ª–∏ —à–æ–≤ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —Å—É–º–º–∞—Ä–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π, –Ω–∞–º –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å (–≤—ã—Ä–µ–∑–∞—Ç—å) –ø–∏–∫—Å–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–∑—É—é—Ç –µ–≥–æ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—É—Ç–µ–º —Å–º–µ—â–µ–Ω–∏—è –ø–∏–∫—Å–µ–ª–µ–π —Å–ø—Ä–∞–≤–∞ –æ—Ç —à–≤–∞ –Ω–∞ <code>1px</code> –≤–ª–µ–≤–æ. –ò–∑ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º—ã –Ω–µ –±—É–¥–µ–º —É–¥–∞–ª—è—Ç—å –∫—Ä–∞–π–Ω–∏–π —Å—Ç–æ–ª–±–∏–∫ –ø–∏–∫—Å–µ–ª–µ–π. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫—É —É–º–µ–Ω—å—à–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Ç—É —á–∞—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ª–µ–∂–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –æ–±—Ä–µ–∑–∞–Ω–Ω–æ–π —à–∏—Ä–∏–Ω—ã.</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/60-deleting-example.png" alt="Deleting the seam" tabindex="0" loading="lazy"><figcaption>Deleting the seam</figcaption></figure><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// Deletes the seam from the image data.</span>
<span class="token comment">// We delete the pixel in each row and then shift the rest of the row pixels to the left.</span>
<span class="token keyword">const</span> deleteSeam <span class="token operator">=</span> <span class="token punctuation">(</span>img<span class="token operator">:</span> ImageData<span class="token punctuation">,</span> seam<span class="token operator">:</span> Seam<span class="token punctuation">,</span> <span class="token punctuation">{</span> w <span class="token punctuation">}</span><span class="token operator">:</span> ImageSize<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  seam<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> seamX<span class="token punctuation">,</span> y<span class="token operator">:</span> seamY <span class="token punctuation">}</span><span class="token operator">:</span> Coordinate<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> seamX<span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token punctuation">(</span>w <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> nextPixel <span class="token operator">=</span> <span class="token function">getPixel</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">:</span> seamY <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setPixel</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token operator">:</span> seamY <span class="token punctuation">}</span><span class="token punctuation">,</span> nextPixel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="—É–¥–∞–ª–µ–Ω–∏–µ-–æ–±—ä–µ–∫—Ç–æ–≤-—Å-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è" tabindex="-1"><a class="header-anchor" href="#—É–¥–∞–ª–µ–Ω–∏–µ-–æ–±—ä–µ–∫—Ç–æ–≤-—Å-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è" aria-hidden="true">#</a> –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h2><p>Seam Carving –∞–ª–≥–æ—Ä–∏—Ç–º –ø—ã—Ç–∞–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç—å —à–≤—ã, —Å–æ—Å—Ç–æ—è—â–∏–µ –∏–∑ –Ω–∏–∑–∫–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏—Ö –ø–∏–∫—Å–µ–ª–µ–π. –ú—ã –º–æ–≥–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–∫—Ç –∏, –ø—Ä–∏—Å–≤–æ–∏–≤ –Ω–∏–∑–∫—É—é —ç–Ω–µ—Ä–≥–∏—é –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø–∏–∫—Å–µ–ª—è–º –≤—Ä—É—á–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—Ä–∏—Å–æ–≤–∞–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –º–∞—Å–∫—É), –º—ã –º–æ–≥–ª–∏ –±—ã –∑–∞—Å—Ç–∞–≤–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º —É–¥–∞–ª–∏—Ç—å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ (<em>–æ–±—ä–µ–∫—Ç—ã</em>).</p><p>–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ <code>getPixelEnergy()</code> –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª—ã —Ü–≤–µ—Ç–æ–≤ <code>R</code>, <code>G</code>, <code>B</code> –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –ø–∏–∫—Å–µ–ª–µ–π. –ù–æ –µ—Å—Ç—å –µ—â–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä <code>A</code> (–∞–ª—å—Ñ–∞, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å), –∫–æ—Ç–æ—Ä—ã–π –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏. –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã &quot;—Å–∫–∞–∑–∞—Ç—å&quot; –∞–ª–≥–æ—Ä–∏—Ç–º—É, —á—Ç–æ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ ‚Äî —ç—Ç–æ —Ç–µ –ø–∏–∫—Å–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ö–æ—Ç–∏–º —É–¥–∞–ª–∏—Ç—å. –í—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å <a href="https://github.com/trekhleb/js-image-carver/blob/main/src/utils/contentAwareResizer.ts#L54" target="_blank" rel="noopener noreferrer">–∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ getPixelEnergy()<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, –∫–æ—Ç–æ—Ä–∞—è —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å.</p><p>–í–æ—Ç –∫–∞–∫ –ø—Ä–∏ —ç—Ç–æ–º –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤:</p><figure><img src="https://raw.githubusercontent.com/trekhleb/trekhleb.github.io/master/src/posts/2021/content-aware-image-resizing-in-javascript/assets/10-demo-02.gif" alt="JS IMAGE CARVER OBJECT REMOVAL DEMO" tabindex="0" loading="lazy"><figcaption>JS IMAGE CARVER OBJECT REMOVAL DEMO</figcaption></figure><h2 id="–ø—Ä–æ–±–ª–µ–º—ã-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-–∏-–¥–∞–ª—å–Ω–µ–∏—à–∏–µ-–ø–ª–∞–Ω—ã" tabindex="-1"><a class="header-anchor" href="#–ø—Ä–æ–±–ª–µ–º—ã-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-–∏-–¥–∞–ª—å–Ω–µ–∏—à–∏–µ-–ø–ª–∞–Ω—ã" aria-hidden="true">#</a> –ü—Ä–æ–±–ª–µ–º—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏ –¥–∞–ª—å–Ω–µ–π—à–∏–µ –ø–ª–∞–Ω—ã</h2><p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ <a href="https://github.com/trekhleb/js-image-carver" target="_blank" rel="noopener noreferrer">JS IMAGE CARVER<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> –¥–∞–ª–µ–∫–æ –æ—Ç –∏–¥–µ–∞–ª–∞ –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º production-ready –∫–∞—á–µ—Å—Ç–≤–∞. –û—Å–Ω–æ–≤–Ω–æ–π –µ–≥–æ —Ü–µ–ª—å—é –±—ã–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º. –ü–æ—ç—Ç–æ–º—É –≤ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –ø–ª–∞–Ω–∞—Ö ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –∏–º–µ–Ω–Ω–æ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.</p><p>–í <a href="https://perso.crans.org/frenoy/matlab2012/seamcarving.pdf" target="_blank" rel="noopener noreferrer">–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è, –Ω–æ –∏ –¥–ª—è <strong>—É–≤–µ–ª–∏—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</strong>. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ) –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è <strong>–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ –µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–π —à–∏—Ä–∏–Ω—ã –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤</strong>.</p><p>–ï—â–µ –æ–¥–Ω–æ–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π –æ–±–ª–∞—Å—Ç—å—é —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ø—ã—Ç–∫–∞ —É—Å–∫–æ—Ä–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –≤ —Ä–µ–∂–∏–º–µ <strong>—Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</strong>.</p><blockquote><p>–¢–∞–∫–æ–≤—ã –ø–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ, –Ω–æ –ø–æ–∫–∞, –Ω–∞–¥–µ—é—Å—å, –ø—Ä–∏–º–µ—Ä —Å —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª –∏–Ω—Ç–µ—Ä–µ—Å–µ–Ω –∏ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –≤–∞—Å. –¢–∞–∫–∂–µ –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ –≤–∞–º –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É–≤–∏–¥–µ—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∑–∞–¥–∞—á–∞—Ö, –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã—Ö –∫ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏.</p><p>–£–¥–∞—á–∏ —Å –≤–∞—à–∏–º–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏!</p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/linwu-hi/coding-time/edit/main/docs/lc/algorithms/image-processing/seam-carving/README.ru-RU.md" rel="noopener noreferrer" target="_blank" aria-label="Âú® GitHub ‰∏äÁºñËæëÊ≠§È°µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Âú® GitHub ‰∏äÁºñËæëÊ≠§È°µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">‰∏äÊ¨°ÁºñËæë‰∫é: </span><!----></div><div class="contributors"><span class="label">Ë¥°ÁåÆËÄÖ: </span><!--[--><!--[--><span class="contributor" title="email: linwu.hi@gmail.com">linwu-hi</span><!--]--><!--]--></div></div></footer><!----><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><!----></div><!--]--><!----><!----><div class="qrcode-ui" data-v-85ffe88e><div class="qrcode-container" data-v-85ffe88e><div class="tencent-code" data-v-85ffe88e><h4 data-v-85ffe88e>ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑</h4><p data-v-85ffe88e>ÂíåÂ∞è‰ºô‰º¥‰ª¨‰∏ÄËµ∑Â≠¶‰π†</p> <img src="/assets/gzh.jpg" alt="" data-v-85ffe88e></div><div class="group_code" data-v-85ffe88e><h4 data-v-85ffe88e>Âä†ÂÖ•ÊäÄÊúØ‰∫§ÊµÅÁæ§</h4><p data-v-85ffe88e>Êâ´Êèè‰∫åÁª¥Á†Å Â§áÊ≥®<span data-v-85ffe88e>Âä†Áæ§</span></p><img class="wx" src="/assets/wx.jpg" alt="" data-v-85ffe88e></div></div></div><!--]--></div>
    <script type="module" src="/assets/app-d7df62a4.js" defer></script>
  </body>
</html>
